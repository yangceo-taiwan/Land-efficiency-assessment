<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°å—å¸‚åœŸåœ°é–‹ç™¼æ•ˆç›Šè©•ä¼°å„€è¡¨æ¿ V3.3</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* V3.3 å°ˆæ¥­ç™½é‡‘é…è‰² */
            --primary-navy: #0F2E46;    /* å®åœ‹ç©©é‡è— */
            --primary-gold: #C5A065;    /* æ˜“ä¸è³ªæ„Ÿé‡‘ */
            --bg-main: #F0F2F5;
            --bg-card: #FFFFFF;
            --text-dark: #1A1A1A;
            --text-grey: #666666;
            --border-line: #E1E4E8;
            
            --success-green: #27AE60;
            --line-green: #06C755;      /* LINE å®˜æ–¹ç¶  */
            --alert-red: #E74C3C;
            --chart-base: #2980B9;
            --chart-bonus: #F39C12;
        }

        * { box-sizing: border-box; outline: none; }
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--bg-main);
            color: var(--text-dark);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        /* --- Header --- */
        header {
            background: var(--bg-card);
            border-top: 5px solid var(--primary-gold);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 25px;
        }
        .logo-group {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            align-items: center;
        }
        .logo-img { height: 60px; width: auto; }
        h1 { margin: 0; color: var(--primary-navy); font-size: 1.8rem; font-weight: 700; text-align: center; }
        .subtitle { color: var(--text-grey); font-size: 0.95rem; margin-top: 5px; }

        /* --- Layout --- */
        .grid-layout {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
            max-width: 1200px;
            margin: 0 auto;
        }
        @media(min-width: 992px) {
            .grid-layout { grid-template-columns: 380px 1fr; }
        }

        /* --- Card Styles --- */
        .card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.03);
            border: 1px solid var(--border-line);
        }
        h2 {
            font-size: 1.2rem;
            color: var(--primary-navy);
            border-bottom: 2px solid var(--bg-main);
            padding-bottom: 10px;
            margin-top: 0;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* --- Inputs --- */
        .input-group { margin-bottom: 20px; }
        .input-label { display: block; font-weight: 600; margin-bottom: 8px; color: var(--primary-navy); font-size: 0.95rem; }
        .input-wrapper { position: relative; }
        .input-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #CCC;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
            background: #FAFAFA;
        }
        .input-control:focus { border-color: var(--primary-navy); background: #FFF; box-shadow: 0 0 0 3px rgba(15, 46, 70, 0.1); }
        .unit-tag {
            position: absolute; right: 15px; top: 50%; transform: translateY(-50%);
            color: #888; font-size: 0.85rem; font-weight: 500;
            background: #EEE; padding: 2px 6px; border-radius: 4px;
        }

        .convert-box {
            background: rgba(197, 160, 101, 0.1);
            border: 1px dashed var(--primary-gold);
            color: var(--primary-navy);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
            margin-top: -10px;
            margin-bottom: 20px;
        }
        .convert-val { font-size: 1.2rem; color: var(--primary-gold); margin: 0 5px; }

        .slider-box { margin-bottom: 25px; }
        .slider-header { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.9rem; font-weight: 600; }
        input[type=range] { width: 100%; cursor: pointer; accent-color: var(--primary-navy); }

        /* --- KPI & Charts --- */
        .kpi-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }
        .kpi-card {
            background: linear-gradient(145deg, var(--primary-navy), #0a2336);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 10px rgba(15, 46, 70, 0.2);
        }
        .kpi-card.gold {
            background: linear-gradient(145deg, var(--primary-gold), #b08d55);
            box-shadow: 0 4px 10px rgba(197, 160, 101, 0.3);
        }
        .kpi-title { font-size: 0.85rem; opacity: 0.9; margin-bottom: 5px; }
        .kpi-value { font-size: 1.8rem; font-weight: 700; }
        .kpi-unit { font-size: 0.9rem; opacity: 0.8; }

        .bar-chart-wrapper { margin-bottom: 20px; }
        .bar-chart {
            height: 30px;
            background: #E0E0E0;
            border-radius: 15px;
            overflow: hidden;
            display: flex;
        }
        .bar-seg { height: 100%; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; color: white; font-weight: bold; transition: width 0.5s; }
        .bar-seg.base { background: var(--chart-base); }
        .bar-seg.bonus { background: var(--chart-bonus); }
        .legend { display: flex; justify-content: center; gap: 15px; font-size: 0.85rem; color: var(--text-grey); margin-top: 8px; }
        .legend-dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 5px; }

        /* --- Rule Table --- */
        .rule-section {
            background: #F8F9FA;
            border-left: 4px solid var(--primary-navy);
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
        }
        .rule-title { font-weight: 700; color: var(--primary-navy); margin-bottom: 10px; display: block; }
        .rule-table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
        .rule-table th { text-align: left; padding: 8px; border-bottom: 2px solid #ddd; color: var(--text-grey); }
        .rule-table td { padding: 8px; border-bottom: 1px solid #eee; vertical-align: top; }
        .highlight { color: var(--alert-red); font-weight: bold; }
        .status-badge { display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; font-weight: bold; margin-right: 5px; }
        .status-ok { background: rgba(39, 174, 96, 0.15); color: var(--success-green); }
        .status-no { background: rgba(231, 76, 60, 0.15); color: var(--alert-red); }

        /* --- CTA (Call to Action) Section --- */
        .cta-section {
            margin-top: 30px;
            background: linear-gradient(135deg, #fff 0%, #f0f8ff 100%);
            border: 2px solid var(--primary-gold);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(197, 160, 101, 0.15);
        }
        .cta-title { font-size: 1.2rem; color: var(--primary-navy); font-weight: 800; margin-bottom: 10px; }
        .cta-desc { font-size: 0.95rem; color: #555; margin-bottom: 20px; line-height: 1.5; }
        .cta-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            background-color: var(--line-green);
            color: white;
            text-decoration: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 1rem;
            box-shadow: 0 4px 10px rgba(6, 199, 85, 0.3);
            transition: all 0.3s;
            cursor: pointer;
            border: none;
            width: 100%;
            max-width: 300px;
        }
        .cta-btn:hover { background-color: #05a546; transform: translateY(-2px); box-shadow: 0 6px 15px rgba(6, 199, 85, 0.4); }

    </style>
</head>
<body>

<header>
    <div class="logo-group">
        <img src="å®åœ‹åœ°æ”¿å°é¢.jpg" alt="å®åœ‹åœ°æ”¿" class="logo-img">
        <img src="æ˜“ä¸logo-01.jpg" alt="æ˜“ä¸åœ°æ”¿" class="logo-img">
    </div>
    <h1>å°å—å¸‚åœŸåœ°é–‹ç™¼æ•ˆç›Šè©•ä¼°</h1>
    <div class="subtitle">è¼¸å…¥ mÂ² è‡ªå‹•æ›ç®—åªæ•¸ï½œæ•´åˆå°å—éƒ½æ›´å®¹ç©çå‹µæ³•è¦</div>
</header>

<div class="grid-layout">
    
    <div class="card">
        <h2>ğŸ—ï¸ åŸºåœ°æ¢ä»¶è¨­å®š</h2>
        
        <div class="input-group">
            <label class="input-label" for="inputSqm">1. åœŸåœ°é¢ç© (mÂ²)</label>
            <div class="input-wrapper">
                <input type="number" id="inputSqm" class="input-control" value="500" min="10" placeholder="è«‹è¼¸å…¥æ¬Šç‹€é¢ç©">
                <span class="unit-tag">å¹³æ–¹å…¬å°º</span>
            </div>
        </div>

        <div class="convert-box">
            æ›ç®—åªæ•¸ï¼š<span id="displayPing" class="convert-val">151.25</span> åª
        </div>

        <div class="input-group">
            <label class="input-label" for="inputRoad">2. é¢è‡¨é“è·¯å¯¬åº¦</label>
            <div class="input-wrapper">
                <input type="number" id="inputRoad" class="input-control" value="10" min="4">
                <span class="unit-tag">å…¬å°º (M)</span>
            </div>
        </div>

        <div class="input-group">
            <label class="input-label" for="inputZone">3. åœŸåœ°ä½¿ç”¨åˆ†å€</label>
            <div class="input-wrapper">
                <select id="inputZone" class="input-control">
                    <option value="res">ä½å®…å€ (Residential)</option>
                    <option value="com">å•†æ¥­å€ (Commercial)</option>
                </select>
            </div>
        </div>

        <div class="input-group">
            <label class="input-label" for="inputBaseRate">4. åŸºæº–å®¹ç©ç‡ (%)</label>
            <div class="input-wrapper">
                <input type="number" id="inputBaseRate" class="input-control" value="200" step="10">
                <span class="unit-tag">%</span>
            </div>
        </div>

        <h2 style="margin-top: 30px; font-size: 1.1rem;">âš–ï¸ å®¹ç©å¢é‡æ¨¡æ“¬</h2>
        
        <div class="slider-box">
            <div class="slider-header">
                <span>å±è€/éƒ½æ›´çå‹µ</span>
                <span style="color:var(--primary-navy)"><span id="valBonus">20</span>%</span>
            </div>
            <input type="range" id="sliderBonus" min="0" max="50" value="20">
        </div>

        <div class="slider-box">
            <div class="slider-header">
                <span>å®¹ç©ç§»è½‰</span>
                <span style="color:var(--primary-navy)"><span id="valTrans">10</span>%</span>
            </div>
            <input type="range" id="sliderTrans" min="0" max="40" value="10">
        </div>
    </div>

    <div class="card">
        <h2>ğŸ“Š é–‹ç™¼æ•ˆç›Šé ä¼° (å¤§æ¨“é‡å»º)</h2>

        <div class="kpi-container">
            <div class="kpi-card">
                <div class="kpi-title">é ä¼°ç¸½éŠ·å”®é¢ç©</div>
                <div class="kpi-value" id="resSalesArea">0</div>
                <div class="kpi-unit">åª</div>
            </div>
            <div class="kpi-card gold">
                <div class="kpi-title">ç¶œåˆåœŸåœ°åªæ•ˆ</div>
                <div class="kpi-value" id="resEfficiency">0.0</div>
                <div class="kpi-unit">åª/åª (éŠ·åª/åœ°åª)</div>
            </div>
        </div>

        <div class="bar-chart-wrapper">
            <div class="bar-chart">
                <div id="barBase" class="bar-seg base" style="width: 70%">åŸºæº–</div>
                <div id="barBonus" class="bar-seg bonus" style="width: 30%">å¢é‡</div>
            </div>
            <div class="legend">
                <span><span class="legend-dot" style="background:var(--chart-base)"></span>åŸºæº–å®¹ç© <b id="txtBase">200</b>%</span>
                <span><span class="legend-dot" style="background:var(--chart-bonus)"></span>ç¸½æ ¸å®š <b id="txtTotal">260</b>%</span>
            </div>
        </div>

        <div class="rule-section">
            <span class="rule-title">ğŸ“˜ å°å—å¸‚éƒ½å¸‚æ›´æ–°å®¹ç©çå‹µé€ŸæŸ¥</span>
            <table class="rule-table">
                <thead>
                    <tr>
                        <th width="25%">é …ç›®</th>
                        <th>ç›¸é—œè¦å®šèˆ‡é–€æª»</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>ä¸Šé™è¦å®š</strong></td>
                        <td>ä¸€èˆ¬åœ°å€ <span class="highlight">1.5å€</span> / ç­–ç•¥åœ°å€ <span class="highlight">2.0å€</span></td>
                    </tr>
                    <tr>
                        <td><strong>è¦æ¨¡çå‹µ</strong></td>
                        <td>åŸºåœ° > 3,000 mÂ² æˆ– å®Œæ•´è¡—å»“ å¯ç²é¡å¤–çå‹µ</td>
                    </tr>
                    <tr>
                        <td><strong>å®¹ç©ç§»è½‰</strong></td>
                        <td>
                            <span id="ruleTransStatus"></span><br>
                            <small style="color:#666">*å¯¦éš›éœ€ä¾å°å—å¸‚ç´°å‰‡æª¢è¨</small>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="cta-section">
            <div class="cta-title">æ‚¨çš„åœŸåœ°ï¼Œå€¼å¾—æ›´å°ˆæ¥­çš„è¦åŠƒ</div>
            <p class="cta-desc">
                è©¦ç®—çµæœåƒ…ä¾›åƒè€ƒã€‚æˆ‘å€‘æ˜¯å°ˆæ¥­åœ°æ”¿åœ˜éšŠï¼Œèƒ½ç‚ºæ‚¨æä¾›<br>
                <strong>ã€Œä¸å‹•ç”¢ç¨…å‹™è¦åŠƒã€ã€ã€Œç”¢æ¬Šç§»è½‰ã€èˆ‡ã€Œåœ°æ”¿æ³•è¦è«®è©¢ã€</strong>ã€‚
            </p>
            
            <button onclick="sendToLine()" class="cta-btn">
                ğŸ’¬ å‚³é€è©¦ç®—çµæœï¼Œå–å¾—å°ˆæ¥­è«®è©¢
            </button>
        </div>

        <p style="font-size:0.8rem; color:#999; margin-top:15px; text-align:center;">
            *è¨»ï¼šéŠ·å”®åªæ•¸ä¿‚ä»¥ 1.6 å€ä¿‚æ•¸ä¼°ç®—ã€‚å¯¦éš›è¦åŠƒéœ€ä¾å»ºç¯‰å¸«æª¢è¨ç‚ºæº–ã€‚
        </p>
    </div>
</div>

<script>
    // --- åƒæ•¸èˆ‡å¸¸æ•¸ ---
    const SQM_TO_PING = 0.3025; 
    const RULES = {
        TRANS_RES_AREA: 500, TRANS_RES_ROAD: 8,
        TRANS_COM_AREA: 1000, TRANS_COM_ROAD: 10
    };

    // --- DOM å…ƒç´  ---
    const el = {
        sqm: document.getElementById('inputSqm'),
        displayPing: document.getElementById('displayPing'),
        road: document.getElementById('inputRoad'),
        zone: document.getElementById('inputZone'),
        base: document.getElementById('inputBaseRate'),
        sliderBonus: document.getElementById('sliderBonus'),
        sliderTrans: document.getElementById('sliderTrans'),
        valBonus: document.getElementById('valBonus'),
        valTrans: document.getElementById('valTrans'),
        salesArea: document.getElementById('resSalesArea'),
        eff: document.getElementById('resEfficiency'),
        barBase: document.getElementById('barBase'),
        barBonus: document.getElementById('barBonus'),
        txtBase: document.getElementById('txtBase'),
        txtTotal: document.getElementById('txtTotal'),
        ruleTransStatus: document.getElementById('ruleTransStatus')
    };

    // --- æ ¸å¿ƒè¨ˆç®— ---
    function updateCalc() {
        let sqm = parseFloat(el.sqm.value) || 0;
        let ping = sqm * SQM_TO_PING;
        let road = parseFloat(el.road.value) || 0;
        let baseRate = parseFloat(el.base.value) || 0;
        let bonusRate = parseFloat(el.sliderBonus.value) || 0;
        let transRate = parseFloat(el.sliderTrans.value) || 0;
        let zone = el.zone.value;

        el.displayPing.textContent = ping.toFixed(2);
        el.valBonus.textContent = bonusRate;
        el.valTrans.textContent = transRate;

        // è¨ˆç®—
        let totalRate = baseRate * (1 + (bonusRate + transRate) / 100);
        let totalGFA = ping * (totalRate / 100);
        let salesArea = totalGFA * 1.6;
        let efficiency = (ping > 0) ? (salesArea / ping) : 0;

        // æ›´æ–° UI
        el.salesArea.textContent = Math.round(salesArea).toLocaleString();
        el.eff.textContent = efficiency.toFixed(2);

        // åœ–è¡¨
        el.txtBase.textContent = baseRate;
        el.txtTotal.textContent = Math.round(totalRate);
        let basePercent = (baseRate / totalRate) * 100;
        el.barBase.style.width = basePercent + '%';
        el.barBase.textContent = `åŸºæº– ${Math.round(basePercent)}%`;
        el.barBonus.style.width = (100 - basePercent) + '%';
        el.barBonus.textContent = (100 - basePercent) > 10 ? `å¢é‡ ${Math.round(100 - basePercent)}%` : '';

        // æ³•è¦æ–‡å­—
        checkRegulations(sqm, road, zone);
    }

    function checkRegulations(sqm, road, zone) {
        let text = "";
        if (zone === 'res') {
            text = (sqm >= RULES.TRANS_RES_AREA && road >= RULES.TRANS_RES_ROAD) ? 
                `<span class="status-badge status-ok">ç¬¦åˆ</span> ä½å®…å€é–€æª»` : 
                `<span class="status-badge status-no">æœªé”</span> >${RULES.TRANS_RES_AREA}mÂ² ä¸” >${RULES.TRANS_RES_ROAD}Mè·¯`;
        } else {
            text = (sqm >= RULES.TRANS_COM_AREA && road >= RULES.TRANS_COM_ROAD) ? 
                `<span class="status-badge status-ok">ç¬¦åˆ</span> å•†æ¥­å€é–€æª»` : 
                `<span class="status-badge status-no">æœªé”</span> >${RULES.TRANS_COM_AREA}mÂ² ä¸” >${RULES.TRANS_COM_ROAD}Mè·¯`;
        }
        el.ruleTransStatus.innerHTML = text;
    }

    // --- æ™ºæ…§ LINE å°æµåŠŸèƒ½ ---
    function sendToLine() {
        let sqm = el.sqm.value;
        let ping = document.getElementById('displayPing').textContent;
        let road = el.road.value;
        let zoneText = el.zone.options[el.zone.selectedIndex].text;
        let sales = el.salesArea.textContent;
        let eff = el.eff.textContent;
        
        let msg = `ğŸ‘‹ æ‚¨å¥½ï¼Œæˆ‘å‰›ä½¿ç”¨äº†åœŸåœ°é–‹ç™¼è©•ä¼°å·¥å…·ï¼Œæƒ³é€²ä¸€æ­¥è«®è©¢ï¼š\n\n` +
                  `ğŸ“ åŸºåœ°è³‡è¨Šï¼š\n` +
                  `â€¢ é¢ç©ï¼š${sqm} mÂ² (ç´„ ${ping} åª)\n` +
                  `â€¢ è·¯å¯¬ï¼š${road} ç±³\n` +
                  `â€¢ åˆ†å€ï¼š${zoneText}\n\n` +
                  `ğŸ“Š åˆæ­¥è©¦ç®—çµæœï¼š\n` +
                  `â€¢ é ä¼°éŠ·åªï¼š${sales} åª\n` +
                  `â€¢ åœŸåœ°åªæ•ˆï¼š${eff} å€\n\n` +
                  `æƒ³è«‹æ•™æ›´è©³ç´°çš„ç¨…å‹™è¦åŠƒèˆ‡åœ°æ”¿æ³•è¦åˆ†æï¼Œè¬è¬ï¼`;

        // ä½¿ç”¨ oaMessage æ ¼å¼ç›´æ¥å°æ‡‰ @604gpqef
        let lineUrl = `https://line.me/R/oaMessage/@604gpqef/?${encodeURIComponent(msg)}`;
        
        window.open(lineUrl, '_blank');
    }

    // --- äº‹ä»¶ç¶å®š ---
    const inputs = [el.sqm, el.road, el.zone, el.base, el.sliderBonus, el.sliderTrans];
    inputs.forEach(item => {
        item.addEventListener('input', updateCalc);
        item.addEventListener('change', updateCalc);
    });

    updateCalc();

</script>

</body>
</html>